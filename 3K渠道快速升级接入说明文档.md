### *5.1.16(KKKPlatformSDK版本）,4.6.6(K3IntegratedSDK版本).  2017-10-24*
###### 更新内容：
1. 修复公告接口缓存问题
2. 支付时参数调用优化，防止可能出现cp传递支付时和角色统计时角色信息不同时验证不通过的情况。（**serverId,serverName,roleId,roleName,roleLevel现改为必须参数**)
- 示例
```
 K3IntegratedSDKPaymentInfo *paymentInfo = [[K3IntegratedSDKPaymentInfo alloc] init];
    paymentInfo.amount                     = price;
    paymentInfo.orderTitle                  = ordertitle;
    paymentInfo.notifyURL                   = @"http://paycheck.whj.game1919.com/paycheck/confirm/ThreeK";
    paymentInfo.callback_info               = @"439,aaasaa,3,1";
    paymentInfo.identifiers                 = [NSSet setWithObjects:@"StardustRomance3K60", nil];
    paymentInfo.productId                   = proId;
    
    paymentInfo.serverId = @"100000";
    paymentInfo.serverName = @"服务器名";
    paymentInfo.roleId = @"test_id_01";
    paymentInfo.roleName = @"角色名";
    paymentInfo.roleLevel = @"111";
   
    
    [[K3IntegratedSDK sharedSDK] payWithPaymentInfo:paymentInfo];
```

3. 优化和修复已知问题
###### 更新方法：
1. 已经接过融合版本4.6.0以及以上版本，仅需替换*KKKPlatformSDK.framework,K3IntegratedSDK.framework*
2. 已经接过融合版本4.6.0以及以上版本，请按 **5.1.14(KKKPlatformSDK版本）,4.6.0(K3IntegratedSDK版本).  2017-10-13** 更新方法更新 




### *5.1.14(KKKPlatformSDK版本）,4.6.0(K3IntegratedSDK版本).  2017-10-13*
###### 更新内容：
1. 融合SDK更新，请务必先阅读 **01-3K玩iOS融合版SDK接入指南（客户端）v4.6.6**
###### 更新方法：
1. 替换所有sdk相关库和资源 *(注:3KChannel.plist设置参数需保持和原来一样)*
2. 支付接口传递参数userInfo 需改为 callback_info;
- 示例
`paymentInfo.callback_info               = @"439,aaasaa,3,1";`
3. 角色统计接入方法和参数有变 *(详细接入请查阅融合客户端接入文档)*
- 示例
```
 K3IntegrateRoleInfo *sroleInfo = [K3IntegrateRoleInfo new];
    sroleInfo.server_id = @"100000";
    sroleInfo.server_name = @"服务器名";
    sroleInfo.role_id = @"test_id_01";
    sroleInfo.role_name = @"角色名";
    sroleInfo.role_level = @"111";``
    
    sroleInfo.balance = @"222";
    sroleInfo.vip_level = @"333";
    sroleInfo.guild_name = @"公会名称";
    sroleInfo.guild_id = @"公会id";
    sroleInfo.fighting = @"战力";
    
    if (button.tag == K3RoleSt_create) {
        [[K3IntegratedSDK sharedSDK] submitRoleInfo:sroleInfo type:K3RoleSt_create]; //角色新增后调用
    }
    
    if (button.tag == K3RoleSt_login) {
        [[K3IntegratedSDK sharedSDK] submitRoleInfo:sroleInfo type:K3RoleSt_login]; //角色登陆后调用
    }
    
    if (button.tag == K3RoleSt_levelUp) {
        [[K3IntegratedSDK sharedSDK] submitRoleInfo:sroleInfo type:K3RoleSt_levelUp]; //角色升级后调用
    }
```
   *注：以上各种角色参数都需要有明确的值。如有不能获取到的请发到讨论组确定。（经我方确定可以不传的参数需传@“”).*

4. 需设置一个URL Schemes为 bundleIdentifier 值。*(详细接入请查阅融合客户端接入文档)*

5.  手机防沉迷验证接口  *(详细接入请查阅融合客户端接入文档)*
- 示例
```
#pragma mark - 打开手机验证(防沉迷)页面接口
    [[K3IntegratedSDK sharedSDK]  verifyPhone];
```
```
#pragma mark - 防沉迷检测接口
    [[K3IntegratedSDK sharedSDK] checkPhoneVerifyState];
```
```
//sdk中防沉迷验证成功后通知
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(successVerifyPhone) name:k3KIntegratedSDKVerifyPhoneNotification object:nil];
```

```
//防沉迷认证通过后回调
- (void)successVerifyPhone
{
    NSLog(@"防沉迷认证已经通过");
}
```
6.  sdk登录返回guid 需显示在游戏界面内 *(详细接入请查阅融合客户端接入文档)*
- 示例
```
- (void)loginCallBack:(NSNotification *)notification
{
    NSDictionary *dic = notification.userInfo;
    K3IntegratedSDKCallBackResult *callBackResult = [dic objectForKey:k3KIntegratedSDKCallBackResultKey];
    NSString *tipStr = nil;
    if (callBackResult.result == K3IntegratedSDKResultSuccess)
    {
        
        NSString *userId   = callBackResult.userId;
        NSString *userName = callBackResult.nickName;
        NSString *sign     = callBackResult.kkk_sign;
        NSString *time     = callBackResult.kkk_time;
        NSString *age      = callBackResult.kkk_age;
        NSString *guid  = callBackResult.guid;  //需显示，供玩家查看
        tipStr = [NSString stringWithFormat:@"rh登录成功:\nuserid=%@,\nuserName=%@\nsign=%@,\ntime:%@,age:%@,guid:%@,ext:%@,cp_ext:%@",userId,userName,sign,time,age,guid,callBackResult.ext,callBackResult.cp_ext];
        NSLog(@"%@,cp_ext.class:%@",tipStr,NSStringFromClass(callBackResult.cp_ext.class) );
        /*
         ...开始验证登录，然后登陆游戏
         */
        
        //游戏登录后 应调用角色登录统计或角色新增统计
    
    } else
    {
        NSLog(@"rh登录失败:%@",callBackResult.kkk_error);
        tipStr = @"登录失败";
    }
    _centerResultLabel.text = tipStr;
    
}

```
